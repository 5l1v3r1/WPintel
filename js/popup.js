function wait(e){return new Promise(function(t){setTimeout(t,e)})}var port=chrome.extension.connect({name:"WPintel connection"});function setdetails(e){window.detailstate=!0;try{e[1].endsWith("/")?window.targeturl=e[1].replace(/.$/,""):window.targeturl=e[1],window.sourcecode=e[2],window.parsedsrc=(new DOMParser).parseFromString(window.sourcecode,"text/html"),window.isWP=e[0],detectHome(window.sourcecode,window.targeturl,window.parsedsrc)}catch(e){wpintel_debug("Something wrong with what content.js sent: "+e)}}function detectHome(e,t,n){for(var r=t.split("//")[1].split("/")[0],o="",i=[],a=n.querySelectorAll("[src],[href]"),d=0;d<a.length;++d){var s=a[d];if(null!==s.getAttribute("src"))var c=s.getAttribute("src");if(null!==s.getAttribute("href"))c=s.getAttribute("href");c&&i.push(c)}for(window.alllinks=i,d=0;d<i.length;d++){var l=i[d];if(l){if(l.match(/wp-(content|include)/)){var u=new RegExp("(http://|https://)"+r+"(.*?)/wp-(content|include)");try{o=l.match(u)[1]+r+l.match(u)[2];wpintel_debug("Target Home from src: "+o);break}catch(e){wpintel_debug("Error while matching href: "+l)}}else if(t.match(/\?p=/)){o="http"+(o=t.match(/http(s|):\/\/(.*?)\/\?p=/))[1]+"://"+o[2],wpintel_debug("Target Home from p: "+o);break}}else wpintel_debug("Skipping null href")}if(""!==o&&o.match(r))return window.url=t,window.targeturl=o,!0;o=t.match(/^(?:\w+\:\/\/)?([^\/]+)(.*)$/)[1];return wpintel_debug("Target Home raw: "+o),window.url=t,window.targeturl="http://"+o,!0}function getDetails(){port.postMessage("sendDetails"),chrome.tabs.query({active:!0,currentWindow:!0},function(e){chrome.tabs.sendMessage(e[0].id,{from:"popup",subject:"sendDetails"},setdetails)})}port.onMessage.addListener(function(e){"details"===e[0]&&(wpintel_debug("got details form back"),window.tabID=e[1],"yes"!==window.isWP&&(wpintel_debug("setting isWP to ture by httph: "+e[3]),window.isWP=e[3]),window.http_headers=e[5])}),document.addEventListener("DOMContentLoaded",function(e){getDetails(),setTimeout(function(){if(void 0!==window.detailstate){if(void 0===window.targeturl)return document.getElementById("target").value="Reload or Enter Manually",show_reload(),!1;document.getElementById("target").value=window.targeturl,"yes"===window.isWP?(wpintel_debug("WordPress installation detected"),wordpress_fond(),document.addEventListener("click",function(e){e.target&&"path_scan"==e.target.id?(wpintel_debug("Path disclosure check"),check_path(window.targeturl)):e.target&&"version_scan"==e.target.id?(wpintel_debug("clicked on start scan"),check_version(window.sourcecode,window.parsedsrc,window.targeturl)):e.target&&"theme_scan"==e.target.id?(wpintel_debug("Themes and plugin check"),check_theme(window.alllinks,window.parsedsrc)):e.target&&"reg_scan"==e.target.id?(wpintel_debug("User registration status check"),check_reg(window.targeturl)):e.target&&"user_scan"==e.target.id&&(wpintel_debug("Username Enumeration"),check_users(window.targeturl))})):(wpintel_debug("WordPress installation not detected"),wordpress_not_found())}else wpintel_debug("window.detailstate not set"),show_error("<b>Oops!!!</b><br>Something went wrong.. try refreshing the page")},500)}),document.addEventListener("click",function(e){if(e.target&&"change_target"==e.target.id){wpintel_debug("Target Changed");var t=document.getElementById("target").value;""!==t&&"Reload or Enter Manually"!==t&&(port.postMessage("Redirect[to]"+t),window.close())}else e.target&&"ret_menu"==e.target.id?wordpress_fond():e.target&&"donate_but"==e.target.id&&donate()}),$(document).ready(function(){$("body").on("click","a",function(){return chrome.tabs.create({url:$(this).attr("href")}),!1}),document.querySelector("body").addEventListener("click",function(e){"relaod_but"===e.target.id&&(wpintel_debug("Pressed the reload button"),chrome.tabs.reload(window.tabID),window.close())})});var _AnalyticsCode="UA-62536809-6";const version=chrome.runtime.getManifest().version;var _gaq=_gaq||[];function trackButtonClick(e){_gaq.push(["_trackEvent",e.target.id,"clicked","Ext version: "+version])}_gaq.push(["_setAccount",_AnalyticsCode]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://ssl.google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),document.addEventListener("DOMContentLoaded",function(){for(var e=document.querySelectorAll("button"),t=0;t<e.length;t++)e[t].addEventListener("click",trackButtonClick)});